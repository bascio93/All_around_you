<% provide(:title, "Home") %>
<!DOCTYPE html>
<html>
   <% if logged_in? %>
  <div class="row" align="left">
    <aside class="col-md-4">
      <section class="user_info">
        <%= render 'shared/user_info' %>
      </section>
      <section class="servizi_form">
        <%= render 'shared/servizi_form' %>
      </section>
    </aside>
    <div class="col-md-8">
      <h3>Servizi erogati:</h3>
      <%= render 'shared/feed' %>
    </div>
    <div class="col-md-8">
      <%= link_to "Mostra preferiti", preferiti_path %>
    </div>
    <section class="ricerca_form">
       <%= render 'shared/ricerche_form' %>
   </section>
   <section class="Cercavicino">
        <button id="cercavicino"> Cerca vicino te </button>
    </section>
    <br>
    <br>
    <br>
    <div id="servizivicini">
    Servizi vicini:
    </div>
   <script>
  function initAutocomplete() {
    var indirizzi = document.getElementsByClassName('indirizzi');
    var indirizzo1=indirizzi[0];
    var indirizzo2=indirizzi[1];
    var cerca1 = new google.maps.places.Autocomplete(indirizzo1, {
      types: ['geocode']
});
   var cerca2= new google.maps.places.Autocomplete(indirizzo2, {
      types: ['geocode']
});
    cerca1.addListener('place_changed', function() {
      var places1 = cerca1.getPlace();
    });
    cerca2.addListener('place_changed', function() {
      var places2 = cerca2.getPlace();
    });
  }
  </script>
   <script src="https://maps.googleapis.com/maps/api/js?key=AIzaSyCQIh8MGEehUptz2u7vr8JbRvyvB6mA4M8&libraries=places&callback=initAutocomplete"
     async defer></script>
  <script src="http://code.jquery.com/jquery-1.6.4.min.js" type="text/javascript"></script>
  <script type="text/javascript">
  $(document).ready(function(){
     $("#cercavicino").click(function(){
      if (navigator.geolocation){
        var position=navigator.geolocation.getCurrentPosition(function(position){
        var lat = position.coords.latitude;
        var long= position.coords.longitude;
        $.ajax({
          url: '/cercaservizi',
          type: 'POST',
          data:{
          latitude: lat,
          longitude: long
          },
          success: function(response) {
          $("#servizivicini").html(response)
         }
      });
    });
    }
    });
  });
</script>
  <% else %>


    <head>
        <title><%= yield(:title) %> | All Around You App</title>



        <style>
          @import url('https://fonts.googleapis.com/css?family=Merriweather');

          #par1{
            font-family: 'Merriweather', serif;
            font-size: 25px;
            color: white;

          }

          h2{
            font-family: 'Merriweather', serif;
            color: white;
          }

          #par2{
            font-family: 'Merriweather', serif;
            font-size: 20px;
            color: grey;
          }

          #par3{

            background-color:white;
            width:360px;
            height:80px;
            margin:0 auto;
            margin-top:50px;
            font-family:arial;color:white;
            text-align:center;
            border: white 1px solid;

          }

        </style>


    </head>
    <body bgcolor="black">
        <center>

          <div id="par1">
            <h1>All Around You</h1>
          </div>

        </center>
        <p>

    <div id="par2">
      <center>
        Con All Around You puoi trovare facilmente i servizi pi√π vicini a te!
      </center>
    </div>

    <div id = "par3">
      <p> <h2><%= link_to "Registrati!", signup_path, id: 'registrati' %></p></h2>
    </div>

    <div id = "par3">
    <p><h2><%= link_to "Loggati!", login_path, id: 'loggati' %></h2></p>
    </div>
    <div id ="par3">
    <%= link_to "Sign in with Google", user_google_oauth2_omniauth_authorize_path, id:'oauth' %>
    </div>
    </p>
    </body>
   <% end %>
</html>
